<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Home</title>
		<script type="text/javascript" src="/webjars/js-cookie/js.cookie.js">
			$.ajaxSetup({
				beforeSend : function(xhr, settings) {
					if (settings.type == 'POST' || settings.type == 'PUT'
						|| settings.type == 'DELETE') {
						if (!(/^http:.*/.test(settings.url) || /^https:.*/
							.test(settings.url))) {
							// Only send the token to relative URLs i.e. locally.
							xhr.setRequestHeader("X-XSRF-TOKEN",
								Cookies.get('XSRF-TOKEN'));
						}
					}
				}
			});
			$.get("/user", function(data) {
				$("#user").html(data.name);
				$(".unauthenticated").hide()
				$(".authenticated").show()
			});
			var logout = function() {
				$.post("/logout", function() {
					$("#user").html('');
					$(".unauthenticated").show();
					$(".authenticated").hide();
				})
				return true;
			}
			$.get("/error", function(data) {
				if (data) {
					$(".error").html(data);
				} else {
					$(".error").html('');
				}
			});
		</script>
	</head>
	<body>
		<div class="container unauthenticated">
			With GitHub: <a href="/oauth2/authorization/olx">click here</a>
		</div>
		<div class="container authenticated">
			Logged in as: <span id="user"></span>
			<div>
				<button onClick="logout()" class="btn btn-primary">Logout</button>
			</div>
		</div>
		<div class="container text-danger error"></div>
	</body>
</html>